```st
(*
===============================================================================
 README_Paster — документация проекта пастеризатора для ПР102 (OwenLogic)
===============================================================================
 Назначение:
   Управление пастеризатором с режимами CIP, пастеризации и розлива.
   Основной контроллер — ОВЕН ПР102 с конфигурацией OwenLogic.
   Проект опирается на стандартные типы BOOL / UDINT / REAL и секундный тик.
   Детализация функциональных блоков см. в разделе архитектуры.
*)

PROGRAM README_Paster
VAR CONSTANT
    Project_Name           : STRING := 'Paster (пастеризатор ПР102)';
    Target_Controller      : STRING := 'ОВЕН ПР102';
    Engineering_Environment: STRING := 'OwenLogic (типовая библиотека)';
    Base_Types             : STRING := 'BOOL / UDINT / REAL';
END_VAR;

// ============================================================================
// 1. Архитектура функциональных блоков
// ============================================================================
(*
  FB_Main_PR102 — главный координирующий блок. Он читает дискретные входы
  (аварии мешалки, нагревателя, уровень рубашки и т.д.), секунды Seconds_UD,
  а также сетевые регистры HMI (CmdMask, параметры дозы и расхода). Блок
  выполняет пересчёт аналоговых температур в REAL и подготавливает значения
  для TemperatureManager без формирования гистерезиса, чтобы логику
  регулирования вёл FB_TemperatureManager_v2.【F:src/fb/FB_Main_PR102.st†L1-L36】

  FB_TemperatureManager_v2 реализует регулирование нагрева: поддержка режима
  PID или гистерезиса, тайм-пропорциональный ШИМ с параметром периода,
  фильтрацию температур IIR и ограничение по разности между рубашкой и
  продуктом. Он управляет группами нагревателей через каскад порогов и
  выдаёт команды нагрева и аналоговый процент мощности.【F:src/fb/FB_TemperatureManager.st†L1-L36】

  FB_PasteurManager отвечает за стадии HEAT, HOLD, COOL и управляет насосом
  циркуляции, мешалкой, клапанами охлаждения и запросом мощности нагрева.
  Он поддерживает рецептурный режим, маску стадий и команды стопа/пропуска
  этапов.【F:src/fb/FB_PasteurManager.st†L1-L33】

  FB_CIPManager_v2 — движок мойки на месте с семью циклами и тремя этапами
  каждый. Использует сетевые регистры 528..533, 569, 570 для редактирования
  уставок, поддерживает маски режимов Full/Alk/Acid/Rinse, живые записи и
  защиту от конфликтов реагентов. Выдаёт команды на клапаны, насосы и
  мешалку CIP.【F:src/fb/FB_CIPManager.st†L1-L38】

  FB_DosingManager обеспечивает непрерывный и порционный розлив, используя
  датчик «пистолет на месте», внешнюю кнопку и заданный объём дозы. Работает
  с абсолютным счётчиком расхода и формирует импульс завершения порции и
  команду на насос розлива.【F:src/fb/FB_DosingManager.st†L1-L36】

  FB_SoftFlowmeter — программный расходомер, интегрирующий расход по секундному
  тику. Содержит защиту от рывков (ограничение дельты времени), поддерживает
  сброс и выдаёт абсолютный объём и приращение за шаг.【F:src/fb/FB_SoftFlowmeter.st†L1-L36】

  FB_ActuatorManager агрегирует команды от PasteurManager, CIPManager,
  DosingManager и TemperatureManager, а также ручные команды и блокировки.
  Он распределяет управление всеми исполнительными устройствами (клапаны,
  насосы, нагреватели) и учитывает маски активных режимов и наличие ПЧ.
  Мешалка CIP управляется отдельным входом CIP_Mixer_ON.【F:src/fb/FB_ActuatorManager.st†L1-L41】

  FB_VFDManager реализует обмен с ПЧ AD30 по Modbus: преобразует заданную
  частоту из 0..1000 (0..100 %) в слова 0..50000 (0,01 Гц), формирует слово
  команд (пуск вперёд/реверс/стоп) и контролирует бит аварии по статусу
  привода.【F:src/fb/FB_VFDManager.st†L1-L39】
*)

// ============================================================================
// 2. Стандартные переменные и retain-данные
// ============================================================================
(*
  Файл docs/Pasterizator_Стандартные_Переменные.csv описывает стандартные
  переменные OwenLogic. Здесь определены процессные величины (PV_TempProduct,
  PV_TempJacket), параметры мешалки и розлива, команды обслуживания и ручные
  флаги. Переменные распределены по каталогам (Process/PV, Mixer/Params,
  Dispense/Params и т.д.) и имеют пометки retain там, где требуется хранение
  (например, PAR_DosingEnabled). Значения уставок (SP_DoseVolume, PAR_PumpFlow)
  синхронизируются с HMI через сетевые регистры.【F:docs/Pasterizator_Стандартные_Переменные.csv†L1-L19】
*)

// ============================================================================
// 3. Сетевые регистры Modbus
// ============================================================================
(*
  «Pasterizator_Сетевые, Слот 1.csv» содержит карту регистров HMI: маски
  аварий и состояний (512..517), температуры продукта и рубашки в 0,1 °C,
  маски этапов CIP/пастеризации, шаговые индикаторы и уставки (HeatTemp,
  SmoothTemp, время мойки). Также определены команды частоты ПЧ (518) и
  ограничения скорости мешалки (536).【F:docs/Pasterizator_Сетевые, Слот 1.csv†L1-L19】

  «ПР102_Сетевые_Слот_2_Master_AD30_v4.csv» описывает связь со вторым слотом
  (Master Modbus AD30) для управления частотным преобразователем: регистры
  задания частоты в процентах и Гц, командное слово, статус и мониторинг
  токов/напряжений. Все регистры помечены как Remote/VFD.【F:docs/ПР102_Сетевые_Слот_2_Master_AD30_v4.csv†L1-L14】
*)

// ============================================================================
// 4. Документация оборудования
// ============================================================================
(*
  Каталог docs содержит сопроводительные документы: паспорт ВДП, руководство
  пользователя, схему шкафа и проектную документацию. Они используются для
  инженерной привязки, согласования IO и требований безопасности.
*)

// ============================================================================
// 5. Рекомендации по использованию в OwenLogic
// ============================================================================
(*
  1. Создайте проект ПР102 и импортируйте стандартные переменные и сетевые
     карты CSV в соответствующие каталоги (Process, HMI, VFD).
  2. Добавьте перечисленные функциональные блоки в библиотеку и разместите
     их в основном цикле: FB_Main_PR102 как корневой, остальные — по схеме
     вызовов (Main → Managers → ActuatorManager).
  3. Обеспечьте передачу секундного тика Seconds_UD, сетевых регистров HMI
     и физических входов/выходов согласно описанию блоков.
  4. Настройте retain-переменные и параметры (например, PAR_UsePID,
     PAR_PWM_Period_s, маски CIP) через HMI для запуска режимов.
  5. Проведите проверку CIP и пастеризации с учётом защит: команды CMD_Stop,
     ALM_NoWater, блокировка нагрева при превышении ΔT рубашки.
*)

END_PROGRAM
```
